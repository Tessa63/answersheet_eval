<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluation Report | Answer AI</title>
    <meta name="description"
        content="Answer AI evaluation report ‚Äî detailed breakdown of student scores with AI-powered semantic analysis.">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@600;700;800&display=swap"
        rel="stylesheet">
</head>

<body>

    <div class="container">

        <!-- Score Summary Banner -->
        <div class="score-summary" style="animation: fadeInDown .7s ease both;">
            <div class="score-label">Total Score</div>
            <div class="total-score">{{ exam_data.total_score }}</div>
            <div class="max-score">out of {{ exam_data.max_score }}</div>
            {% if exam_data.max_score > 0 %}
            <div class="score-percent">
                {{ ((exam_data.total_score / exam_data.max_score) * 100) | round(1) }}%
            </div>
            {% endif %}
        </div>

        <!-- Question Breakdown -->
        <div class="question-list">
            {% for item in exam_data.breakdown %}
            {% set ratio = item.score / item.max_marks if item.max_marks > 0 else 0 %}
            {% set score_class = 'score-high' if ratio >= 0.8 else 'score-med' if ratio >= 0.5 else 'score-low' %}
            {% set is_challenge = item.type == 'challenge' %}
            {% set opacity_class = 'unselected' if item.selected == False or is_challenge else '' %}

            <div class="question-card {{ score_class }} {{ opacity_class }}">
                <div class="q-score-box">
                    <span class="q-score-val">{{ item.score }}</span>
                    <span class="q-score-max">/ {{ item.max_marks }}</span>
                </div>

                <div class="q-content">
                    <div class="q-header">
                        <div class="q-title">Q{{ item.question }}</div>
                        {% if is_challenge %}
                        <span class="tag"
                            style="background: rgba(124,58,237,.15); color: #a78bfa; border-color: rgba(124,58,237,.25);">üèÜ
                            Challenge (Not Counted)</span>
                        {% elif item.selected == False %}
                        <span class="tag-warning">Not Counted (OR Alternative)</span>
                        {% elif item.type == 'optional' %}
                        <span class="tag"
                            style="background: rgba(6,182,212,.12); color: var(--accent-2); border-color: rgba(6,182,212,.2);">OR
                            Question (Selected)</span>
                        {% endif %}
                    </div>
                    <div class="q-feedback">
                        {{ item.feedback }}
                    </div>
                    {% if item.details %}
                    <div class="q-meta">
                        <span class="tag">Similarity: {{ item.details.similarity }}</span>
                        <span class="tag">Coverage: {{ item.details.concept_coverage }}</span>
                    </div>
                    {% endif %}

                    <!-- Score bar -->
                    <div class="score-bar-track">
                        <div class="score-bar-fill" style="width: {{ (ratio * 100) | round(1) }}%;"></div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Footer -->
        <div class="footer">
            <a href="/" class="btn-secondary" style="margin-bottom: 16px;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
                Evaluate Another
            </a>
            <p>Powered by Answer AI</p>
        </div>
    </div>

</body>

</html>